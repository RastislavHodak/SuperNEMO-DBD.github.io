<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Falaise: Using The FLReconstruct Application</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Falaise
   &#160;<span id="projectnumber">2.1.0</span>
   </div>
   <div id="projectbrief">SuperNEMO Software Toolkit</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Using The FLReconstruct Application </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#usingflreconstruct_intro">Introduction to FLReconstruct </a></li>
<li class="level1"><a href="#usingflreconstruct_examples">Example Usage </a></li>
<li class="level1"><a href="#usingflreconstruct_usingstandardpipelines">Using Standard Pipelines </a></li>
<li class="level1"><a href="#usingflreconstruct_usingoutputpaths">Writing Reconstruction Results to File </a></li>
<li class="level1"><a href="#usingflreconstruct_usingcustompipelines">Using Custom Pipelines </a></li>
</ul>
</div>
<div class="textblock"><h1><a class="anchor" id="usingflreconstruct_intro"></a>
Introduction to FLReconstruct </h1>
<p>FLReconstruct's task is to read data from an output file generated by the SuperNEMO simulation or detector, perform reconstruction on each event in the data, and write the reconstructed data to an output file. It uses a pipeline architecture for event processing, the pipeline is constructed as a sequence of "modules", the sequence of modules being selected by the user (i.e. you) at runtime. Falaise provides a standard set of pipelines and modules, and you can write your own custom pipeline scripts and modules which FLReconstruct can load at runtime via a plugin mechanism.</p>
<p>Here we present a brief overview of running FLReconstruct from the command line using the standard pipeline scripts. The more advanced topics of scripting the pipeline and writing custom modules are covered in the <a class="el" href="writingflreconstructpipelinescripts.html">Writing FLReconstruct Pipeline Scripts</a> and <a class="el" href="writingflreconstructmodules.html">Writing FLReconstruct Modules</a> tutorials.</p>
<h1><a class="anchor" id="usingflreconstruct_examples"></a>
Example Usage </h1>
<p>The flreconstruct program is a command line application just like any other Unix style program (e.g. <code>ls</code>). In the following, we will write commands assuming that <code>flreconstruct</code> is in your path. If is not, simply use the relative or absolute path to <code>flreconstruct</code>.</p>
<p>You can get help on the options that can be passed to <code>flreconstruct</code> by running it with the <code>-h</code> or <code>--help</code> options, e.g.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;$ flreconstruct --help</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;flreconstruct 1.0.0</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;Usage:</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;  flreconstruct [options]</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;Options</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;  -h [ --help ]                 print this help message</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;  --help-module-list            list available modules and exit</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;  --help-module [mod]           print help for a single module and exit</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;  --help-pipeline-list          list available pipeline configurations and exit</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;  --version                     print version number</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;  -v [ --verbose ] [level] (=1) set verbosity level of logging</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;  -i [ --input-file ] [file]    file from which to read data</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;  -o [ --output-file ] [file]   file to which to write data</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;  -p [ --pipeline ] [file]      run pipeline script or resource</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;$</div></div><!-- fragment --><p>The <code>--version</code> option provides detailed information of the current status of the application, including which libraries it uses:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;$ flreconstruct --version</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;flreconstruct 1.0.0</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;Copyright (C) 2013-2014 SuperNEMO Collaboration</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;flreconstruct uses the following external libraries:</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;* Falaise : 1.0.0</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;* Bayeux  : 1.0.0</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;* Boost   : 105500</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;$</div></div><!-- fragment --><p>The exact versions you see will depend on the version you are using and the versions of external packages linked.</p>
<p>To examine a data file output by the <code>flsimulate</code> application, you need to supply, at minimum, an input file. By default, this will simply dump information on each event held in the file to standard output (i.e. the current terminal). For example, say we have a file <code>example.brio</code>, then we can dump events in that file by doing:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;$ flreconstruct -i example.brio</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;flreconstruct::default:</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;`-- Bank &#39;SD&#39; : &quot;mctools::simulated_data&quot;</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;    |-- Properties : &lt;empty&gt;</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;    |   `-- &lt;no property&gt;</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;    |-- Collection type : 1</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;    |-- Collections of step hit handles :</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;    |   |-- Category &#39;calo&#39; has 2 hit(s) [capacity=2]</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;    |   `-- Category &#39;gg&#39; has 31 hit(s) [capacity=31]</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;    |-- Primary event :</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;    |   |-- Auxiliary properties: &lt;none&gt;</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;    |   |-- Label : &#39;Se82.0nubb&#39;</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;    |   |-- Time  : 0 s</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;    |   |-- Particles: [2]</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;    |   |   |-- Particle #0 :</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;    |   |   |   |-- Generation Id  : &lt;none&gt;</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;    |   |   |   |-- Type           : 3 (label=&#39;e-&#39;)</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;    |   |   |   |-- PDG code       : &lt;none&gt;</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;    |   |   |   |-- Mass           : 0.510999 MeV</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;    |   |   |   |-- Charge         : -1 e</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    |   |   |   |-- Time           : 0 ns</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    |   |   |   |-- Kinetic energy : 2.4231 MeV</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    |   |   |   |-- Momentum       : (-0.903124,0.824222,2.6178) MeV</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    |   |   |   |-- Vertex         : &lt;no vertex&gt;</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    |   |   |   |-- Auxiliary properties: &lt;none&gt;</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    |   |   |   `-- Valid          : 1</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    |   |   `-- Particle #1 :</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    |   |       |-- Generation Id  : &lt;none&gt;</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    |   |       |-- Type           : 3 (label=&#39;e-&#39;)</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    |   |       |-- PDG code       : &lt;none&gt;</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    |   |       |-- Mass           : 0.510999 MeV</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    |   |       |-- Charge         : -1 e</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    |   |       |-- Time           : 0 ns</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    |   |       |-- Kinetic energy : 0.571898 MeV</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    |   |       |-- Momentum       : (-0.700223,-0.622764,-0.182756) MeV</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    |   |       |-- Vertex         : &lt;no vertex&gt;</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    |   |       |-- Auxiliary properties: &lt;none&gt;</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    |   |       `-- Valid          : 1</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    |   |-- GENBB weight : 1</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    |   |-- Classification : &#39;2e0p0g0a0X&#39;</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    |   `-- Valid: 1</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    `-- Vertex : (-0.0440134,1597.93,40.6704) mm</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;... further events ...</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;$</div></div><!-- fragment --><h1><a class="anchor" id="usingflreconstruct_usingstandardpipelines"></a>
Using Standard Pipelines </h1>
<p>FLReconstruct implements a "pipeline" architecture in which events flow through an ordered sequence of "modules". Each module performs a specific task on the event (e.g. count hits), writing its results into the event for further processing by downstream modules. The sequence of modules and their configuration (e.g. algorithm parameters) in the pipeline are constructed via a <code>datatools::multi_properties</code> script. A set of pipeline scripts are supplied with Falaise by the Software Board to provide easy to use, validated reconstruction chains.</p>
<p>The available pipelines can be viewed by passing the <code>--help-pipeline-list</code> argument to <code>flreconstruct</code>. This will print a tree of the available pipelines</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;$ flreconstruct --help-pipeline-list</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;@falaise:pipeline</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160; +-&quot;snemo.demonstrator&quot;</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;   +-&quot;1.0.0&quot;</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;   +-&quot;1.0.0.visual&quot;</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;$</div></div><!-- fragment --><p>Standard pipeline scripts are organised into directories based on the experiment they apply to, and should only be used for reconstructing data from these experiments. Note that <code>flreconstruct</code> does not validate that a pipeline script can be applied to the input data. Scripts for each experiments are tagged with a version and optional visualization tag. You should always regard the highest version tag as the current approved script to use for production. The visualization tag adds a final GNUPlot based visualization of each event after pipeline processing, so can be used to view events and the results of reconstruction. Visualization enabled scripts should not be used for production purposes due to their interactive nature.</p>
<p>Built in pipelines can be run in <code>flreconstruct</code> by passing with the <code>-p</code> argument using the "resource path" notation:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;$ flreconstruct -i example.brio -p @falaise:pipeline/snemo.demonstrator/1.0.0</div></div><!-- fragment --><p>Here <code>@falaise:</code> is simply shorthand for "the root directory of standard
Falaise resources" and can be viewed as a "mount point" for standard resources. The subsequent path is simply the path from that root to a standard pipeline script. This path can be derived from the information output by the <code>--help-pipeline-list</code> argument described above.</p>
<h1><a class="anchor" id="usingflreconstruct_usingoutputpaths"></a>
Writing Reconstruction Results to File </h1>
<p>Running <code>flreconstruct</code> as presented above will process data but not persist any reconstruction results to file (e.g. for later analysis). To write results to file, the <code>-o</code> option may be used to write processed events to a file supplied as the argument, with the output format chosen based on the file extension.</p>
<p>To output to the BRIO format recognised by <code>flreconstruct</code> use the <code>.brio</code> extension:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;$ flreconstruct -i example.brio -p @falaise:pipeline/snemo.demonstrator/1.0.0 -o results.brio</div></div><!-- fragment --><p>The resultant file may be examined directly to see what data has been written by simply passing it back to <code>flreconstruct</code>, e.g.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;$ flreconstruct -i results.brio</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;... output ...</div></div><!-- fragment --><p>It may also be further processed by <code>flreconstruct</code> using a pipeline constructed from your own analysis modules. Please see the document on <a class="el" href="flreconstructpipelineoutput.html">FLReconstruct Pipeline Output</a> for details of the data structures stored for each processed event. Further documents are available detailing <a class="el" href="writingflreconstructmodules.html">how to write your reconstruction/analysis modules</a>, and <a class="el" href="workingwitheventrecords.html">how to access event data from modules</a>.</p>
<p>Output to ROOT format is also possible by supplying an output file with the <code>.root</code> extension:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;$ flreconstruct -i example.brio -p @falaise:pipeline/snemo.demonstrator/1.0.0 -o results.root</div></div><!-- fragment --><p>The resultant file contains a single flat <code>TTree</code> structure that may be browsed interactively. Note that currently this format only outputs simulated and calibrated data, with no further reconstruction results. A separate <a class="el" href="usingflptd2root.html">converter program is available</a> for running full conversion, and will be gradully integrated into flreconstruct for direct conversion.</p>
<h1><a class="anchor" id="usingflreconstruct_usingcustompipelines"></a>
Using Custom Pipelines </h1>
<p>The standard pipelines provided by Falaise are intended to cover a wide range of use cases for standard reconstruction tasks leading to analyses. However, if you need to study improvements to the reconstruction via tuning existing modules or adding new ones then custom pipeline scripts can be used in <code>flreconstruct</code>. The <a class="el" href="writingflreconstructpipelinescripts.html">Writing FLReconstruct Pipeline Scripts</a> tutorial covers the syntax and structure of custom pipeline scripts. </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
